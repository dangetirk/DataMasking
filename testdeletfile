# ...

def process_config_entries(config_entries, input_dir, mask_folder):
    path = os.getcwd()
    for entry in config_entries:
        src_file = entry['src_file']
        column_mappings = entry['columns']
        src_folder = entry['src_folder']

        output_dir = os.path.join(path, mask_folder, src_folder)
        os.makedirs(output_dir, exist_ok=True)

        input_file_path = os.path.join(input_dir, src_folder, src_file)

        if not os.path.isfile(input_file_path):
            logger.warning(f"The file '{input_file_path}' does not exist. Skipping this file.")
            continue

        output_file = os.path.join(output_dir, src_file.replace('.csv', '_mask.csv'))

        with open(input_file_path, 'r') as file:
            csv_reader = csv.reader(file, delimiter='|')
            header = next(csv_reader)
            rows = list(csv_reader)

        column_mappings = dict(column.split('=') for column in column_mappings.split(','))

        for i in range(len(rows)):
            for column, fake_data_type in column_mappings.items():
                if fake_data_type in fake_data_functions:
                    column_index = int(column) - 1
                    value = rows[i][column_index]
                    if '"' in value:
                        rows[i][column_index] = value
                    else:
                        rows[i][column_index] = fake_data_functions[fake_data_type]()

        with open(output_file, 'w', newline='') as file:
            csv_writer = csv.writer(file, delimiter='|')
            csv_writer.writerow(header)
            csv_writer.writerows(rows)

        logger.info(f"Masked file saved to {output_file}")

# ...
